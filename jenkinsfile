pipeline {
    agent any
    environment{
	JAVA_HOME ='usr/bin/jvm/java'
    }
    stages{
	stage('Build'){
		steps {
		   sh 'mvn compile'
		}
	}
	stage('Test'){
	   steps{
	    wrap([$class: 'Xvfb',displayName: 67,displayNameOffset: 0,timeout:10,debug:true]){
		sh 'mvn test'
	    }
	   }
	}
	 stage('Publish') {
            steps {
                step([$class: 'Publisher', escapeExceptionMsg: true, escapeTestDescp: true, failureOnFailedTestConfig: false, reportFilenamePattern: '**/testng-results.xml', showFailedBuilds: false, thresholdMode: 2, unstableSkips: 100, failedSkips: 100, unstableFails: 0, failedFails: 100])
            }
        }

    }
}
