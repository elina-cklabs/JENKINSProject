pipeline {
    agent any
    environment{
	JAVA_HOME ='usr/bin/jvm/java'
    }
    stages{
	stage('Build'){
		steps {
		   sh 'mvn compile'
		}
	}
	stage('Test'){
	   steps{
	    wrap([$class: 'Xvfb',displayName: 67,displayNameOffset: 0,timeout:10,debug:true]){
		sh 'mvn test'
	    }
	   }
	}
	stage('Publish'){
	   step([$class:'Publisher', reportFilenamePattern:'**/testng-results.xml', escapeTestDescp: true, escapeExceptionMsg: true, showFailedBuilds: false, failureOnFailedTestConfig: false, unstableSkips: 100, unstableFails: 0, failedSkips: 100, failedFails:0, thresholdMode:2])
	}
    }
}